Option Compare Database


Private Sub Command17_Click()



End Sub

Private Sub Command26_Click()

Me.Combo4.Value = ""
Me.Combo4.RowSource = ""
Me.Text14.Value = ""
Me.Text14.RowSource = ""
Me.Text0.Value = ""
Me.Text0.RowSource = ""

Me.Text0.RowSource = ""
Me.Text0.RowSource = "SELECT DISTINCT [SAM Analyst] FROM [Asset Details] " & _
                        "ORDER BY [SAM Analyst];"
Me.Text0.Requery

Me.Combo4.RowSource = ""
Me.Combo4.RowSource = "SELECT DISTINCT [SARC] FROM [Asset Details] " & _
                        "ORDER BY [SARC];"
Me.Combo4.Requery


Me.Text14.RowSource = ""
Me.Text14.RowSource = "SELECT DISTINCT [Citi PIC Name] FROM [Asset Details] " & _
                        "ORDER BY [Citi PIC Name];"
Me.Text14.Requery

End Sub


Private Sub Form_Load()

Forms!Lookup.Controls![Text27] = Forms!Login!Text0.Value
DoCmd.Close acForm, "Login", acSaveNo

Me.Text0.RowSource = ""
Me.Text0.RowSource = "SELECT DISTINCT [SAM Analyst] FROM [Asset Details] " & _
                        "ORDER BY [SAM Analyst];"
Me.Text0.Requery

Me.Combo4.RowSource = ""
Me.Combo4.RowSource = "SELECT DISTINCT [SARC] FROM [Asset Details] " & _
                        "ORDER BY [SARC];"
Me.Combo4.Requery

Me.Text14.RowSource = ""
Me.Text14.RowSource = "SELECT DISTINCT [Citi PIC Name] FROM [Asset Details] " & _
                        "ORDER BY [Citi PIC Name];"
Me.Text14.Requery

End Sub

Private Sub Open_CSG_Click()



End Sub

Private Sub Text0_AfterUpdate()
    
    
        Me.Combo4.RowSource = "SELECT DISTINCT [SARC] FROM [Asset Details] " & _
                    "WHERE ([SAM Analyst] = '" & [Forms]![Lookup]![Text0] & "' AND [SARC] Is Not Null) ORDER BY [SARC];"
        Me.Combo4.Requery
        
        Me.Text14.RowSource = "SELECT DISTINCT [Citi PIC Name] FROM [Asset Details] " & _
                    "WHERE ([SAM Analyst] = '" & [Forms]![Lookup]![Text0] & "' AND [Citi PIC Name] Is Not Null) ORDER BY [Citi PIC Name];"
        Me.Text14.Requery



End Sub

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

Option Compare Database
Public Reviewer As String
Private Sub Command7_Click()

Dim user As String
Dim soeid As String

user = fOSUserName  'API to get network ID
soeid = Nz(DLookup("[Employees]![Staff SOEID]", "Employees", "[Employees]![Staff Name] ='" & [Forms]![Login]![Text0] & "'"), "")

If Me.Text0 <> "" And user = soeid Then
Forms!Login.Visible = False
DoCmd.OpenForm "Lookup"
ElseIf Me.Text0 <> "" And user <> soeid Then
MsgBox ("Name Does not match your SOEID")
Else
MsgBox ("Select Name from Drop Down List")
End If

End Sub

Private Sub Form_Load()

Me.Text0.RowSource = "SELECT DISTINCT [Staff Name] FROM Employees ORDER BY [Staff Name];"
    
End Sub

Private Sub Sign_In_Click()

Dim user As String
Dim soeid As String

user = fOSUserName  'API to get network ID
soeid = Nz(DLookup("[Employees]![Staff SOEID]", "Employees", "[Employees]![Staff Name] ='" & [Forms]![Login]![Text0] & "'"), "")


End Sub

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

'******************** Code Start **************************
' This code was originally written by Dev Ashish.
' It is not to be altered or distributed,
' except as part of an application.
' You are free to use it in any application,
' provided the copyright notice is left unchanged.
'
' Code Courtesy of
' Dev Ashish
'

Function fOSUserName() As String
' Returns the network login name
Dim lngLen As Long, lngX As Long
Dim strUserName As String
    strUserName = String$(254, 0)
    lngLen = 255
    lngX = apiGetUserName(strUserName, lngLen)
    If (lngX > 0) Then
        fOSUserName = Left$(strUserName, lngLen - 1)
    Else
        fOSUserName = vbNullString
    End If
End Function
'******************** Code End **************************

